{
  "info": {
    "_postman_id": "mobile-ukk-api-collection",
    "name": "Mobile UKK API",
    "description": "API Collection untuk Mobile App UKK - Task Management System",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{authToken}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('authToken', response.token);",
                  "    pm.environment.set('userId', response.user.id);",
                  "    pm.environment.set('userName', response.user.name);",
                  "    pm.environment.set('userRole', response.user.globalRole);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@example.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/mobile/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "auth", "login"]
            },
            "description": "Login user dan mendapatkan JWT token"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Dashboard",
      "item": [
        {
          "name": "Get Dashboard Stats",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/dashboard/stats",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "dashboard", "stats"]
            },
            "description": "Mendapatkan statistik dashboard user (total cards, active cards, completed cards, dll)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Projects",
      "item": [
        {
          "name": "Get All Projects",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/projects",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "projects"]
            },
            "description": "Mendapatkan semua project yang user terlibat di dalamnya"
          },
          "response": []
        },
        {
          "name": "Get Project Detail",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.boards && response.boards.length > 0) {",
                  "        pm.environment.set('boardId', response.boards[0].id);",
                  "        if (response.boards[0].cards && response.boards[0].cards.length > 0) {",
                  "            pm.environment.set('cardId', response.boards[0].cards[0].id);",
                  "        }",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/projects/{{projectId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "projects", "{{projectId}}"]
            },
            "description": "Mendapatkan detail project beserta boards dan cards yang di-assign ke user"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Cards",
      "item": [
        {
          "name": "Get Card Detail",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}"]
            },
            "description": "Mendapatkan detail card lengkap dengan comments, subtasks, dan time logs"
          },
          "response": []
        },
        {
          "name": "Update Card Status",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"IN_PROGRESS\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}"]
            },
            "description": "Update status card (TODO, IN_PROGRESS, REVIEW, DONE)"
          },
          "response": []
        },
        {
          "name": "Update Card (Full)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Card Title\",\n  \"description\": \"Updated description\",\n  \"priority\": \"HIGH\",\n  \"status\": \"IN_PROGRESS\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}"]
            },
            "description": "Update card dengan berbagai field"
          },
          "response": []
        },
        {
          "name": "Reset Card",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/reset",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}", "reset"]
            },
            "description": "Reset card ke status TODO dan unassign user"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Comments",
      "item": [
        {
          "name": "Get Comments",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/comments",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}", "comments"]
            },
            "description": "Mendapatkan semua comments dari card"
          },
          "response": []
        },
        {
          "name": "Add Comment",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('commentId', response.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"This is a comment from mobile app\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/comments",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}", "comments"]
            },
            "description": "Menambahkan comment baru ke card"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Subtasks",
      "item": [
        {
          "name": "Add Subtask",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('subtaskId', response.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"New Subtask from Mobile\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/subtasks",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}", "subtasks"]
            },
            "description": "Menambahkan subtask baru ke card"
          },
          "response": []
        },
        {
          "name": "Toggle Subtask",
          "request": {
            "method": "PATCH",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/subtasks/{{subtaskId}}/toggle",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "mobile",
                "cards",
                "{{cardId}}",
                "subtasks",
                "{{subtaskId}}",
                "toggle"
              ]
            },
            "description": "Toggle status subtask (completed/not completed)"
          },
          "response": []
        },
        {
          "name": "Update Subtask",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Subtask Title\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/subtasks/{{subtaskId}}",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "mobile",
                "cards",
                "{{cardId}}",
                "subtasks",
                "{{subtaskId}}"
              ]
            },
            "description": "Update subtask title"
          },
          "response": []
        },
        {
          "name": "Delete Subtask",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/subtasks/{{subtaskId}}",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "mobile",
                "cards",
                "{{cardId}}",
                "subtasks",
                "{{subtaskId}}"
              ]
            },
            "description": "Menghapus subtask"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Time Tracking",
      "item": [
        {
          "name": "Get Time Logs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/time",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}", "time"]
            },
            "description": "Mendapatkan semua time logs dari card"
          },
          "response": []
        },
        {
          "name": "Start Timer",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    const timeLogs = response.timeLogs || [];",
                  "    const activeLog = timeLogs.find(log => log.endTime === null);",
                  "    if (activeLog) {",
                  "        pm.environment.set('timeLogId', activeLog.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/time",
              "host": ["{{baseUrl}}"],
              "path": ["api", "mobile", "cards", "{{cardId}}", "time"]
            },
            "description": "Start timer untuk card (otomatis set status ke IN_PROGRESS dan assign ke user)"
          },
          "response": []
        },
        {
          "name": "Stop Timer",
          "request": {
            "method": "PATCH",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/mobile/cards/{{cardId}}/time/{{timeLogId}}",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "mobile",
                "cards",
                "{{cardId}}",
                "time",
                "{{timeLogId}}"
              ]
            },
            "description": "Stop timer yang sedang berjalan"
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "userName",
      "value": "",
      "type": "string"
    },
    {
      "key": "userRole",
      "value": "",
      "type": "string"
    },
    {
      "key": "projectId",
      "value": "1",
      "type": "string"
    },
    {
      "key": "cardId",
      "value": "",
      "type": "string"
    },
    {
      "key": "boardId",
      "value": "",
      "type": "string"
    },
    {
      "key": "commentId",
      "value": "",
      "type": "string"
    },
    {
      "key": "subtaskId",
      "value": "",
      "type": "string"
    },
    {
      "key": "timeLogId",
      "value": "",
      "type": "string"
    }
  ]
}
